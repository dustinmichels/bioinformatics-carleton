<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>week3</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="pandoc.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="week-3-introduction-to-unixlinux-and-the-server-assembly-with-idba-ud">Week 3: Introduction to Unix/Linux and the Server; Assembly with IDBA-UD</h1>
<p>Rika Anderson Carleton College Dec 23, 2017</p>
<h2 id="connecting-to-liverpool">Connecting to Liverpool</h2>
<h4 id="step-1">Step 1</h4>
<p>We are going to do most of our computational work on a remote server (or computer) called Liverpool, which is a Linux virtual machine set up by Carleton ITS for our course. Liverpool basically lives in a computer somewhere in the CMC. You’ll be accessing it from the lab computers, but you could also access it from your own computer at home. First, you have to learn how to access Liverpool.</p>
<p>Boot as a Mac user on the lab computer.</p>
<h4 id="step-2">Step 2</h4>
<p>Find and open the Terminal application (it should be in “Applications” in the folder called “Utilities”).</p>
<p><em>The terminal is the interface you will use to log in to the remote server for the rest of the course. It is also the interface we will be using to run almost all of the bioinformatics software we will be learning in this course. You can navigate through files on the server or on your computer, copy, move, and create files, and run programs using the Unix commands we learned earlier this week.</em></p>
<h4 id="step-3">Step 3</h4>
<p>We will use something called ssh, or a secure socket shell, to remotely connect to another computer (in this case it will our class server, liverpool). Type the following:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="fu">ssh</span> [username]@liverpool.its.carleton.edu</a></code></pre></div>
<h4 id="step-4">Step 4</h4>
<p>You should see something like this: <code>[your username]@liverpool.its.carleton.edu's password:</code></p>
<p>Type in your Carleton password. NOTE!! You will not see the cursor moving when you type your password. Never fear, it is still registering what you type. Be sure to use the correct capitalization and be wary of typos.</p>
<h4 id="step-5">Step 5</h4>
<p>Whenever you ssh in to liverpool, you end up in your own home directory. Each of you has your own home directory on liverpool. To see where you are, print your current working directory.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="bu">pwd</span></a></code></pre></div>
<blockquote>
<p>How to print your working directory (find out where you are in the system)</p>
</blockquote>
<h4 id="step-6">Step 6</h4>
<p>You should see something like this: <code>/Accounts/[your username]</code></p>
<p>This tells you what your current location is within liverpool, also known as your <strong>path</strong>. But before we actually run any processes, we need to learn a few important things about using a remote shared server.</p>
<h3 id="important-things-to-know-about-when-using-a-remote-shared-server">Important things to know about when using a remote shared server</h3>
<h4 id="step-7-top">Step 7: Top</h4>
<p>One of the most important things to learn when using a remote shared server is how to use proper <strong>server etiquette.</strong> You don’t want to be a computer hog and take up all of the available processing power. Nobody earns friends that way. Similarly, if it looks like someone else is running a computationally intensive process, you might want to wait until theirs is done before starting your own, because running two intensive processes at the same time might slow you both down.</p>
<p>To see what other processes are being run by other users of the same server, type: <code>top</code></p>
<p>You should see something like this:</p>
<figure>
<img src="images/top_screenshot.png" alt="top screenshot" /><figcaption>top screenshot</figcaption>
</figure>
<p>Here, we can see that randerson is the only user on liverpool, I am using a process called top, and it’s taking up 0.3% of one central processing unit (CPU), and zero memory. Not much is going on in this case. (All the other things listed under ‘root’ are processes that the computer is running in the background.) If someone’s process says 100.0 or 98.00 under %CPU, it means they’re using almost one entire CPU. <strong>Liverpool has 10 CPUs and 32 gigabytes of RAM total.</strong> Therefore, we can use up to 10 CPUs. If we try to overload the computer, it means that everyone else’s processes will have to be shared among the available CPUs, which will slow everyone down. If it looks like all 10 CPUs are already being used at a particular time, you might want to wait until later to run your own process.</p>
<p>To quit out of top, type: <code>q</code></p>
<h4 id="step-8-screen">Step 8: Screen</h4>
<p>Sometimes we will run processes that are so computationally demanding that they will run for several hours or overnight. Some processes can sometimes take several days, or even weeks. In order to run these processes, you want to be able to close out your session on the remote server without terminating your process. To do that, you use screen. Type: <code>screen</code></p>
<p>Your terminal will open a clean window. You are now in a screen session. Any processes you start while you are in a screen session will continue running even after you log off of the remote server.</p>
<p>Let’s say you’ve typed the commands for a process, and now you’re ready to exit your screen session to let it run while you do other things. To leave the screen session, type: <code>Control+A d</code></p>
<p>This will “detach” you from the screen session and allow you to do other things. Your screen session is still running in the background.</p>
<p>To resume your screen session to check on things, type: <code>screen -r</code>. (Now you’ve re-entered your screen session.)</p>
<p>To kill your screen session (this is important to tidy up and keep things neat when your process is finished!) type: <code>Control+A k</code>. - The computer will say: <code>Really kill this window [y/n]</code>. You type: <code>y</code>. - If this doesn’t work, you can also type <code>exit</code> to terminate the screen session.</p>
<h2 id="creating-an-assembly-and-evaluating-it">Creating an assembly and evaluating it</h2>
<h4 id="step-9">Step 9</h4>
<p>Let’s say we’ve gone out in to the field and taken our samples, we’ve extracted the DNA, and we’ve sent them to a sequencer. Then we get back the raw sequencing reads. One of the first things we have to do is assemble them. To do that, we’re going to use a software package called IDBA-UD. Bioinformaticians love to debate about which assembler is best, but ultimately it usually depends on the nature of your own dataset. If you find yourself with data like this someday and you want to know which assembler to use, my advice is to try a bunch of them and then compare the results using something like Quast, which we’ll test below. For now, we’re going to use IDBA-UD, which I’ve found to be a good general-purpose assembler.</p>
<p>Make a new directory in your home folder:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="fu">mkdir</span> toy_dataset_directory</a></code></pre></div>
<h4 id="step-10">Step 10</h4>
<p>Change directory into your toy dataset directory:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="bu">cd</span> toy_dataset_directory</a></code></pre></div>
<h4 id="step-11">Step 11</h4>
<p>Copy the toy dataset into your assembly directory. Don’t forget the period at the end! This means you are copying into the directory you are currently in.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="fu">cp</span> /usr/local/data/toy_datasets/toy_dataset_reads.fasta .</a></code></pre></div>
<h4 id="step-12">Step 12</h4>
<p>Run idba-ud on the toy dataset. Here is what these commands mean:</p>
<ol type="1">
<li>Invoke the program <code>idba-ud</code></li>
<li>The <code>-r</code> gives it the “path” (directions) to the reads for your toy dataset. <code>../</code> means it is in the directory outside of the one you’re in.</li>
<li>The <code>-o</code> flag tells the program that you want the output directory to be called “toy_assembly”</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="ex">idba_ud</span> -r toy_dataset_reads.fasta -o toy_assembly</a></code></pre></div>
<h4 id="step-13">Step 13</h4>
<p>When that’s done running, go into your new output directory and take a look at what’s inside:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="bu">cd</span> toy_assembly</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="fu">ls</span></a></code></pre></div>
<h4 id="step-14">Step 14</h4>
<p>You should see several files, including these:</p>
<pre><code>contig.fa
contig-20.fa
contig-40.fa
contig-60.fa
contig-80.fa
contig-100.fa
scaffold.fa</code></pre>
<p>You may recall that De Bruijn graph assembly works by searching reads for overlapping words, or “kmers.” IDBA-UD starts by searching for small kmers to assemble reads into longer contigs. Then it uses those constructed contigs for a new round of assembly with longer kmers. Then it does the same with even longer kmers. It iterates through kmers of length 20, 40, 60, 80, and 100. You should get longer and longer contigs each time. Each “contig-” file gives the results of each iteration for a different kmer size. The “scaffolds.fa” file provides the final scaffolded assembly, which pulls contigs together using the paired-end data.</p>
<h4 id="step-15">Step 15</h4>
<p>Let’s examine the assembly output files. First, take a look at your final scaffold output:</p>
<p><code>less scaffold.fa</code></p>
<h4 id="step-16">Step 16</h4>
<p>You should see a fasta file with some very long sequences in it. When you’re done looking at it, type: <code>q</code>.</p>
</body>
</html>
